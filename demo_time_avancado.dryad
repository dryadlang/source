#<time>
#<console_io>
#<file_io>

// DemonstraÃ§Ã£o avanÃ§ada do mÃ³dulo time
native_println("=== â° MÃ“DULO TIME - DemonstraÃ§Ã£o AvanÃ§ada ===");
native_println("");

// Criando um log de atividades com timestamps
let log_content = "";

let timestamp_inicio = native_now();
let data_inicio = native_date();
let hora_inicio = native_time();

log_content = log_content + "=== LOG DE ATIVIDADES ===\n";
log_content = log_content + "Iniciado em: " + data_inicio + " Ã s " + hora_inicio + "\n";
log_content = log_content + "Timestamp: " + timestamp_inicio + "ms\n\n";

native_println("ğŸ“ Iniciando log de atividades...");

// Simulando vÃ¡rias operaÃ§Ãµes com mediÃ§Ã£o de tempo
native_println("ğŸš€ Executando operaÃ§Ãµes...");

// OperaÃ§Ã£o 1: CÃ¡lculo intensivo
let tempo1 = native_now();
let resultado = 0;
let i = 0;
while i < 500000 {
    resultado = resultado + i;
    i = i + 1;
}
let tempo2 = native_now();
let duracao1 = tempo2 - tempo1;
log_content = log_content + "OperaÃ§Ã£o 1 (cÃ¡lculo): " + duracao1 + "ms\n";
native_println("  âœ… CÃ¡lculo intensivo: " + duracao1 + "ms");

// OperaÃ§Ã£o 2: Sleep
let tempo3 = native_now();
native_sleep(500);
let tempo4 = native_now();
let duracao2 = tempo4 - tempo3;
log_content = log_content + "OperaÃ§Ã£o 2 (sleep 500ms): " + duracao2 + "ms\n";
native_println("  ğŸ’¤ Sleep de 500ms: " + duracao2 + "ms");

// OperaÃ§Ã£o 3: FormataÃ§Ã£o de data
let tempo5 = native_now();
let formato_complexo = native_format_date("DD/MM/YYYY HH:mm:ss");
let tempo6 = native_now();
let duracao3 = tempo6 - tempo5;
log_content = log_content + "OperaÃ§Ã£o 3 (formataÃ§Ã£o): " + duracao3 + "ms\n";
native_println("  ğŸ¨ FormataÃ§Ã£o de data: " + duracao3 + "ms");

// Calculando estatÃ­sticas
let tempo_total = native_uptime();
let timestamp_fim = native_now();
let data_fim = native_date();
let hora_fim = native_time();

log_content = log_content + "\n=== ESTATÃSTICAS ===\n";
log_content = log_content + "Finalizado em: " + data_fim + " Ã s " + hora_fim + "\n";
log_content = log_content + "Timestamp final: " + timestamp_fim + "ms\n";
log_content = log_content + "Tempo total de execuÃ§Ã£o: " + tempo_total + "ms\n";
log_content = log_content + "Tempo real medido: " + (timestamp_fim - timestamp_inicio) + "ms\n";

native_println("");
native_println("ğŸ“Š EstatÃ­sticas finais:");
native_println("  â±ï¸ Uptime total: " + tempo_total + "ms");
native_println("  ğŸ“ Tempo medido: " + (timestamp_fim - timestamp_inicio) + "ms");

// Salvando log em arquivo
native_write_file("time_log.txt", log_content);
native_println("  ğŸ’¾ Log salvo em time_log.txt");

// DemonstraÃ§Ã£o de diferentes fusos (simulaÃ§Ã£o)
native_println("");
native_println("ğŸŒ Formatos de data ao redor do mundo:");

let formato_br = native_format_date("DD/MM/YYYY HH:mm");
let formato_us = native_format_date("MM/DD/YYYY hh:mm A");
let formato_iso = native_format_date("YYYY-MM-DD HH:mm:ss");
let formato_unix = native_timestamp();

native_println("  ğŸ‡§ğŸ‡· Brasil: " + formato_br);
native_println("  ğŸ‡ºğŸ‡¸ EUA: " + formato_us);
native_println("  ğŸŒ ISO: " + formato_iso);
native_println("  ğŸ§ Unix: " + formato_unix);

// Teste de precisÃ£o do sleep
native_println("");
native_println("ğŸ¯ Teste de precisÃ£o do sleep:");

let tempos_sleep = [100, 250, 500, 1000];
let idx = 0;
while idx < 4 {
    let sleep_target = tempos_sleep[idx];
    let antes = native_now();
    native_sleep(sleep_target);
    let depois = native_now();
    let real = depois - antes;
    let precisao = real - sleep_target;
    native_println("  Sleep " + sleep_target + "ms -> Real: " + real + "ms (diff: " + precisao + "ms)");
    idx = idx + 1;
}

native_println("");
native_println("âœ… DemonstraÃ§Ã£o avanÃ§ada do mÃ³dulo TIME concluÃ­da!");
native_println("ğŸ“„ Verifique o arquivo time_log.txt para o log completo.");
